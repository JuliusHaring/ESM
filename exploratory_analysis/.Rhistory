print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste(marker))
dev.list()
dev.off()
}
library(splines)
library(brms)
library(ggplot2)
setwd("~/Projects/ESM/exploratory_analysis")
test <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test){
patient_grp <- patient_grp[0:100,]
}
for(marker in c("ESM_GAS2","ESM_GAS1")){
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste(marker))
dev.list()
dev.off()
}
library(splines)
library(brms)
library(ggplot2)
setwd("~/Projects/ESM/exploratory_analysis")
test <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test){
patient_grp <- patient_grp[0:100,]
}
for(marker in c("ESM_GAS2","ESM_GAS1")){
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste(marker))
print(dev.list())
dev.off()
}
library(splines)
library(brms)
library(ggplot2)
setwd("~/Projects/ESM/exploratory_analysis")
test <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test){
patient_grp <- patient_grp[0:100,]
}
for(marker in c("ESM_GAS2","ESM_GAS1")){
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste(marker))
dev.off()
dev.off()
dev.off()
}
library(splines)
library(brms)
library(ggplot2)
setwd("~/Projects/ESM/exploratory_analysis")
test <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
for(marker in columns){
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste(marker))
dev.off()
dev.off()
}
library(splines)
library(brms)
library(ggplot2)
setwd("~/Projects/ESM/exploratory_analysis")
test <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
for(marker in columns){
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
print(plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste(marker)))
dev.off()
dev.off()
}
library(splines)
library(brms)
library(ggplot2)
setwd("~/Projects/ESM/exploratory_analysis")
test_mode <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test_mode){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
for(marker in columns){
try({
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test_mode){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
print(plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste(marker)))
dev.off()
dev.off()
})
}
library(splines)
library(brms)
library(ggplot2)
setwd("~/Projects/ESM/exploratory_analysis")
test_mode <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test_mode){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
for(marker in columns){
try({
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test_mode){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
print(plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste(marker)))
dev.off()
dev.off()
})
}
library(splines)
library(brms)
library(ggplot2)
setwd("~/Projects/ESM/exploratory_analysis")
test_mode <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test_mode){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
unusable <- c()
for(marker in columns){
tryCatch({
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test_mode){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
print(plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste("ESM_ABDPAIN vs.",marker)))
dev.off()
dev.off()
}, error = function(err) {
unusable <- c(unusable, marker)
})
}
print("Didn't work for:")
print(unusable)
library(splines)
library(brms)
library(ggplot2)
setwd("~/Projects/ESM/exploratory_analysis")
test_mode <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test_mode){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
unusable <- c()
for(marker in columns){
tryCatch({
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test_mode){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
print(plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste("ESM_ABDPAIN vs.",marker)))
dev.off()
dev.off()
}, error = function(err) {
print(paste("______",marker))
unusable <- c(unusable, marker)
})
}
print("Didn't work for:")
print(unusable)
library(splines)
library(brms)
library(ggplot2)
setwd(getSrcDirectory()[1])
test_mode <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test_mode){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
unusable <- c()
for(marker in columns){
tryCatch({
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test_mode){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
print(plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::ggtitle(paste("ESM_ABDPAIN vs.",marker)))
dev.off()
dev.off()
}, error = function(err) {
print(paste("______",marker))
unusable <- c(unusable, marker)
return()
})
}
print("Didn't work for:")
print(unusable)
library(splines)
library(brms)
library(ggplot2)
setwd(getSrcDirectory()[1])
test_mode <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test_mode){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
unusable <- c()
for(marker in columns){
tryCatch({
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test_mode){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
print(plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::xlim(0,10) + ggplot2::ggtitle(paste("ESM_ABDPAIN vs.",marker)))
dev.off()
dev.off()
}, error = function(err) {
print(paste("______",marker))
unusable <- c(unusable, marker)
return(NA)
})
}
print("Didn't work for:")
print(unusable)
library(splines)
library(brms)
library(ggplot2)
setwd(getSrcDirectory()[1])
test_mode <- TRUE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test_mode){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
for(marker in columns){
try({
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test_mode){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
print(plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::xlim(0,10) + ggplot2::ggtitle(paste("ESM_ABDPAIN vs.",marker)))
dev.off()
dev.off()
})
}
library(splines)
library(brms)
library(ggplot2)
setwd(getSrcDirectory()[1])
test_mode <- FALSE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1]
columns <- columns[-1]
if(test_mode){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
for(marker in columns){
try({
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test_mode){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
print(plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::xlim(0,10) + ggplot2::ggtitle(paste("ESM_ABDPAIN vs.",marker)))
dev.off()
dev.off()
})
}
library(splines)
library(brms)
library(ggplot2)
setwd(getSrcDirectory()[1])
test_mode <- FALSE
filtered <- read.csv("../data/filtered.csv")
patient_grp <- filtered[filtered$REGISTRATION_ID < 2,]
test_grp <- filtered[filtered$REGISTRATION_ID > 2,]
columns <- names(patient_grp)
columns <- columns[grepl("ESM_", columns)]
columns <- columns[-1] # Removes ESM_ABDPAIN (target)
if(test_mode){
patient_grp <- patient_grp[0:100,]
columns <- c("ESM_GAS2","ESM_GAS1")
}
for(marker in columns){
try({
formula <- paste("ESM_ABDPAIN~","s(",marker,",by=REGISTRATION_ID, bs='fs')")
if(test_mode){
formula <- paste("ESM_ABDPAIN~","s(",marker,")")
}
formula <- as.formula(formula)
print(formula)
print(paste("NA: ", sum(is.na(patient_grp[marker]))))
print(paste("Availible:", sum(!is.na(patient_grp[marker]))))
fit <- brm(formula, data=patient_grp, iter=2000, chains=1)
summary(fit)
fname <- paste("../images/",marker,".jpeg", sep="")
jpeg(filename = fname,width=3.25,height=3.25,units="in",res=300)
print(plot(marginal_effects(fit), ask=FALSE, plot=FALSE)[[1]] + ggplot2::ylim(0, 10) + ggplot2::xlim(0,10) + ggplot2::ggtitle(paste("ESM_ABDPAIN vs.",marker)))
dev.off()
dev.off()
})
}
